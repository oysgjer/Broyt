<!doctype html>
<html lang="no">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<title>Br√∏yterute ‚Äì Romerike Trefelling (V9.3)</title>
<meta name="theme-color" content="#0f9d58">
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin="">
<style>
  :root{
    --bg:#111;--fg:#f4f6f8;--muted:#b8c0c7;
    --card:#1a1a1a;--cardBorder:#2a2a2a;
    --green:#0f9d58;--red:#c21d03;--blue:#0061fe;--orange:#ff9800;--gray:#2f3337;
  }
  .light{--bg:#f5f6f7;--fg:#111;--muted:#666;--card:#fff;--cardBorder:#e6e6e6;}
  *{box-sizing:border-box}html,body{height:100%;margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
  body{background:var(--bg);color:var(--fg)}#app{min-height:100%;display:grid;grid-template-rows:auto 1fr auto}
  header{background:#0b0b0b;color:#fff;padding:10px 12px;display:flex;align-items:center;gap:10px}
  header h1{font-size:16px;margin:0}.spacer{flex:1}.nav{display:flex;gap:8px}
  .nav .tab{border:none;border-radius:12px;padding:8px 12px;background:#2a2a2a;color:#fff;cursor:pointer}
  .nav .tab.active{background:var(--green)}.btn.s{height:38px;font-size:14px;border-radius:10px;border:1px solid var(--cardBorder);background:#222;color:#fff;cursor:pointer}
  .page{display:none;padding:14px}.page.active{display:block}.card{background:var(--card);border:1px solid var(--cardBorder);border-radius:16px;padding:14px}
  .stack{display:flex;flex-direction:column;gap:12px}.title-lg{font-size:26px;font-weight:700}
  .muted{color:var(--muted)}.row{display:flex;gap:10px;flex-wrap:wrap}.btn{border:none;border-radius:14px;font-size:17px;font-weight:700;cursor:pointer}
  .btn-green{background:var(--green);color:#fff}.btn-red{background:var(--red);color:#fff}.btn-blue{background:var(--blue);color:#fff}.btn-gray{background:var(--gray);color:#fff}
  .b-green{color:#9f9}.b-blue{color:#9cf}.b-yellow{color:#ffb}.b-red{color:#f99}
  .field input[type=text]{flex:1;height:44px;border:1px solid var(--cardBorder);border-radius:10px;padding:0 10px;background:transparent;color:inherit}
  .check{display:flex;align-items:center;gap:8px;background:#171717;border:1px solid var(--cardBorder);padding:8px 10px;border-radius:10px}
  .item{background:var(--card);border:1px solid var(--cardBorder);border-radius:12px;padding:10px;margin-bottom:8px}
  .disabled{opacity:.5}.footer{background:#0b0b0b;color:#fff;padding:8px 12px;display:flex;justify-content:space-between;font-size:12px}
</style>
</head>
<body>
<div id="app">
<header>
  <h1>Br√∏yterute ‚Äì Romerike Trefelling</h1>
  <div class="spacer"></div>
  <div class="nav">
    <button class="tab active" data-tab="home">Hjem</button>
    <button class="tab" data-tab="work">Under arbeid</button>
    <button class="tab" data-tab="register">Adresse-register</button>
    <button class="tab" data-tab="service">Service</button>
  </div>
</header>

<!-- HJEM -->
<div id="page-home" class="page active">
 <div class="card stack">
  <h2>Innstillinger</h2>
  <div class="field"><label style="min-width:90px">Sj√•f√∏r</label><input id="driver" type="text" placeholder="Skriv inn navnet ditt"></div>
  <div class="row">
   <label class="check"><input id="eq_plog" type="checkbox"> Plog</label>
   <label class="check"><input id="eq_fres" type="checkbox"> Fres</label>
   <label class="check"><input id="eq_stro" type="checkbox"> Str√∏kasse</label>
  </div>
  <button id="btnStart" class="btn btn-green">Start runde ‚Üí</button>
 </div>
</div>

<!-- UNDER ARBEID -->
<div id="page-work" class="page">
 <div class="card stack">
  <div id="driverLbl" class="muted"></div>
  <h2 id="curName" class="title-lg">‚Äî</h2>
  <div class="muted">Oppgave: <span id="curTask">‚Äî</span></div>
  <div class="muted">Neste: <span id="curNext">‚Äî</span></div>
  <div class="row">
   <button id="ongo" class="btn btn-gray">‚ñ∂Ô∏è P√•g√•r</button>
   <button id="done" class="btn btn-green">‚úÖ Ferdig</button>
   <button id="block" class="btn btn-red">‚õî Ikke mulig</button>
   <button id="nav" class="btn btn-blue">üß≠ Naviger</button>
   <button id="next" class="btn btn-gray">üîÅ Neste</button>
  </div>
 </div>
</div>

<!-- ADRESSER -->
<div id="page-register" class="page">
 <div id="list"></div>
 <div class="card stack">
  <div class="row">
   <input id="addr" type="text" placeholder="Adresse / omr√•de" style="flex:2">
   <select id="taskSel" style="flex:1">
     <option>Br√∏yte</option><option>Frese</option><option>Str√∏</option>
     <option>Br√∏yte og str√∏</option><option>Frese og str√∏</option><option>Br√∏ytestikker</option>
   </select>
   <button id="add" class="btn btn-green">+ Legg til</button>
  </div>
 </div>
</div>

<!-- SERVICE -->
<div id="page-service" class="page">
 <div class="card stack">
  <h2>Service / Vedlikehold</h2>
  <div class="row">
   <label class="check"><input id="svc_plog" type="checkbox"> Smurt plog</label>
   <label class="check"><input id="svc_fres" type="checkbox"> Smurt fres</label>
   <label class="check"><input id="svc_stro" type="checkbox"> Smurt str√∏kasse</label>
   <label class="check"><input id="svc_other" type="checkbox"> Annet</label>
  </div>
  <textarea id="svcNotes" placeholder="Anmerkninger ‚Ä¶" style="width:100%;min-height:80px;border-radius:10px;padding:8px"></textarea>
 </div>
</div>

<div class="footer"><div id="pos">‚Äî</div><div>Versjon 9.3</div></div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
const S=()=>JSON.parse(localStorage.getItem('broyte')||'{"stops":[]}'),W=s=>localStorage.setItem('broyte',JSON.stringify(s));
let d=S();if(!d.stops.length)d={stops:[{n:"AMFI Eidsvoll",t:"Br√∏yte"},{n:"R√•holt barneskole",t:"Br√∏yte og str√∏"}]};
const $=id=>document.getElementById(id);
const pages=["home","work","register","service"];
document.querySelectorAll(".tab").forEach(b=>b.onclick=()=>{pages.forEach(p=>$("#page-"+p).classList.remove("active"));$(".tab.active")?.classList.remove("active");b.classList.add("active");$("#page-"+b.dataset.tab).classList.add("active");if(b.dataset.tab==="register")renderList();});
$("#driver").oninput=e=>{d.driver=e.target.value;W(d);}
$("#btnStart").onclick=()=>{show("work");renderWork();}
function show(p){pages.forEach(x=>$("#page-"+x).classList.remove("active"));$("#page-"+p).classList.add("active");document.querySelectorAll(".tab").forEach(t=>t.classList.toggle("active",t.dataset.tab===p));}
function renderWork(){const cur=d.stops.find(s=>!s.f);const nxt=d.stops.find((s,i)=>!s.f&&i>d.stops.indexOf(cur));$("#driverLbl").textContent="Sj√•f√∏r: "+(d.driver||"‚Äî");$("#curName").textContent=cur?cur.n:"‚Äî";$("#curTask").textContent=cur?cur.t:"‚Äî";$("#curNext").textContent=nxt?nxt.n:"‚Äî";}
["ongo","done","block","nav","next"].forEach(id=>$(id).onclick=()=>act(id));
function act(a){let cur=d.stops.find(s=>!s.f);if(!cur)return;if(a==="nav"){window.open("https://www.google.com/maps/dir/?api=1&destination="+encodeURIComponent(cur.n));return;}
if(a==="done")cur.f=true;if(a==="block")cur.b=true;if(a==="next"){cur.f=true;};W(d);renderWork();}
$("#add").onclick=()=>{d.stops.push({n:$("#addr").value,t:$("#taskSel").value});$("#addr").value="";W(d);renderList();}
function renderList(){$("#list").innerHTML=d.stops.map((s,i)=>`<div class='item${s.f?' disabled':''}'><b>${i+1}. ${s.n}</b><br><span>${s.t}</span> ${s.f?'‚úÖ':''}</div>`).join("")}
</script>
</body>
</html>
